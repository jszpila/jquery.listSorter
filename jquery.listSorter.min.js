(function($){$.fn.listSorter=function(){return this.each(function(){var self=$(this);$(self).children('.sortFilters').children('a').each(function(){$(this).click(function(event){event.preventDefault();var theFilter=$(this);if(!$(theFilter).hasClass('activeSortFilter')){$(theFilter).parent().children('a').removeClass('activeSortFilter');$(theFilter).addClass('activeSortFilter');$(theFilter).parent().parent().children('.sortList').each(function(){$.fn.listSorter.SortList($(this),$(theFilter).attr('data-SortByField'),$(theFilter).attr('data-SecondarySortField'),$(theFilter).attr('data-SortDirection'))})}})})})}$.fn.listSorter.SortList=function(theList,sortBy,secondarySort,sortDir){var listItems=$(theList).children('li').get();if(!$.fn.listSorter.HasValue(sortBy)){sortBy='alpha'}if(!$.fn.listSorter.HasValue(secondarySort)){secondarySort=false}if(!$.fn.listSorter.HasValue(sortDir)){sortDir='asc'}theList=$.fn.listSorter.RemoveClassesWithPrefix(theList,"sort_");$(theList).addClass('sort_'+sortBy+'_'+sortDir);listItems.sort(function(a,b){var compA=$.fn.listSorter.GetComparisonValue(a,sortBy),compB=$.fn.listSorter.GetComparisonValue(b,sortBy),compVal=null;if(!secondarySort){compVal=(compA<compB)?-1:(compA>compB)?1:0}else{if(compA!=compB){compVal=(compA<compB)?-1:(compA>compB)?1:0}else{var compA2=$.fn.listSorter.GetComparisonValue(a,secondarySort),compB2=$.fn.listSorter.GetComparisonValue(b,secondarySort);compVal=(compA2<compB2)?1:(compA2>compB2)?-1:0}}return compVal});if(sortDir=='desc'){listItems.reverse()}for(var i=0;i<listItems.length;i++){listItems[i]=$.fn.listSorter.RemoveClassesWithPrefix(listItems[i],'sortRank_');if(sortBy!='alpha'){$(listItems[i]).addClass('sortRank_'+sortBy+'_'+$(listItems[i]).attr(sortBy))}else{$(listItems[i]).addClass('sortRank_'+sortBy+'_'+$(listItems[i]).text().substring(0,1).toUpperCase())}}$.each(listItems,function(itemIndex,theItem){theList.append(theItem)})}$.fn.listSorter.RemoveClassesWithPrefix=function(theElement,classPrefix){var classList=$(theElement).attr('class').split(/\s+/);$.each(classList,function(classIndex,className){if(className!=""&&className.substring(0,classPrefix.length)==classPrefix){$(theElement).removeClass(className)}});return theElement}$.fn.listSorter.GetComparisonValue=function(theElement,theAttribute){var theValue='';if(theAttribute=='alpha'){theValue=$.trim($(theElement).text().toLowerCase())}else{theValue=$.trim($(theElement).attr(theAttribute))}return theValue}$.fn.listSorter.HasValue=function(theVar){return typeof(theVar)!='undefined'&&theVar!=null&&theVar!=""}})(jQuery);